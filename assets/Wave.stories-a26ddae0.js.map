{"version":3,"file":"Wave.stories-a26ddae0.js","sources":["../../src/stories/components/wave/index.vue"],"sourcesContent":["<template>\n  <div id=\"Wave\"></div>\n</template>\n\n<script setup lang=\"ts\">\nimport { onMounted, onBeforeUpdate, watch, onBeforeMount } from 'vue';\nimport * as THREE from 'three'\nimport { scene, renderer, camera } from '../basic/three'\n// import { controls } from '../basic/controls'\nimport { createWaveMesh } from '../../../../packages/index'\n\nconst props = defineProps({\n  size: {\n    type: Number,\n    default: 20,\n    required: false\n  },\n  color: {\n    type: String,\n    default: '#15de1d',\n    required: false\n  }\n})\n\nlet timer: any = null\n\nonBeforeMount(() => {\n  if (timer) cancelAnimationFrame(timer)\n  scene.remove.apply(scene, scene.children)\n})\n\nonMounted(() => {\n  camera.zoom = 1;\n  const WaveMesh = createWaveMesh(props.size, props.color)\n  WaveMesh.position.z = 0\n  WaveMesh.rotateX(-Math.PI / 4)\n  scene.add( WaveMesh );\n  const axesHelper = new THREE.AxesHelper(5000);\n  // scene.add(axesHelper);\n  const WaveElement = document.getElementById('Wave')\n  if (WaveElement) WaveElement.appendChild(renderer.domElement)\n  const render = () => {\n    renderer.render(scene, camera)\n    camera.updateProjectionMatrix()\n    // controls.update()\n    timer = requestAnimationFrame(render)\n  }\n\n  render()\n})\n\nonBeforeUpdate(() => {\n  console.log('onBeforeUpdate')\n  renderer.clear()\n  scene.remove.apply(scene, scene.children)\n  scene.remove.apply(scene, scene.children)\n  renderer.forceContextLoss()\n  cancelAnimationFrame(timer)\n  const gl = renderer.domElement.getContext('webgl')\n  gl && gl.getExtension('WEBGL_lose_context')?.loseContext()\n})\n</script>"],"names":["timer","onBeforeMount","scene","onMounted","camera","WaveMesh","createWaveMesh","props","THREE.AxesHelper","WaveElement","renderer","render","__name","onBeforeUpdate","gl","_a"],"mappings":"waAwBA,IAAIA,EAAa,KAEjB,OAAAC,EAAc,IAAM,CACdD,GAAO,qBAAqBA,CAAK,EACrCE,EAAM,OAAO,MAAMA,EAAOA,EAAM,QAAQ,CAAA,CACzC,EAEDC,EAAU,IAAM,CACdC,EAAO,KAAO,EACd,MAAMC,EAAWC,EAAeC,EAAM,KAAMA,EAAM,KAAK,EACvDF,EAAS,SAAS,EAAI,EACtBA,EAAS,QAAQ,CAAC,KAAK,GAAK,CAAC,EAC7BH,EAAM,IAAKG,CAAS,EACD,IAAIG,EAAiB,GAAI,EAEtC,MAAAC,EAAc,SAAS,eAAe,MAAM,EAC9CA,GAAyBA,EAAA,YAAYC,EAAS,UAAU,EAC5D,MAAMC,EAASC,EAAA,IAAM,CACVF,EAAA,OAAOR,EAAOE,CAAM,EAC7BA,EAAO,uBAAuB,EAE9BJ,EAAQ,sBAAsBW,CAAM,CAAA,EAJvB,UAORA,GAAA,CACR,EAEDE,EAAe,IAAM,OACnB,QAAQ,IAAI,gBAAgB,EAC5BH,EAAS,MAAM,EACfR,EAAM,OAAO,MAAMA,EAAOA,EAAM,QAAQ,EACxCA,EAAM,OAAO,MAAMA,EAAOA,EAAM,QAAQ,EACxCQ,EAAS,iBAAiB,EAC1B,qBAAqBV,CAAK,EAC1B,MAAMc,EAAKJ,EAAS,WAAW,WAAW,OAAO,EACjDI,KAAMC,EAAAD,EAAG,aAAa,oBAAoB,IAApC,MAAAC,EAAuC,cAAY,CAC1D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}